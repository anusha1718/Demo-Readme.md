**Install Vault cli by**

```

https://releases.hashicorp.com/vault/1.0.1/vault_1.0.1_linux_amd64.zip

```

**To unzip the file**

```

unzip the file

```

**To set VAULT_ADDR env variable by run the following command**

```

export VAULT_ADDR=https://localhost:8200

```
**create an approle**

* For creating approle first we have to write a policy and attach that policy to the role.

 * example create a policy file as token-policy.hcl
 
 ```
 path "secret/K8sToken" {
 capabilities = ["create", "read", "list", "update"]
 }
 ```
**To create a policy by**
  
```
      ./vault policy write k8stoken token-policy.hcl
      
```
* To create a role in Vault and associate the policy with that role

     ```
     ./vault write auth/approle/role/k8s-role token_ttl=6h policies="k8stoken"

     ```
* Role ID for the k8s-role role can be fetched by
  
    ```
    
    ./vault read auth/approle/role/k8s-role/role-id

    ```
* secret ID for the k8s-role is generated by

    ```

    ./vault write -f auth/approle/role/k8s-role/secret-id

    ```
* To login to the k8s-role by

    ```

    ./vault write auth/approle/login role_id=xxxxxxx  secret_id=xxxxxxxxx

    ```
* To run the script token.sh. In the script we have to cd to the path where vault binary is there.

   ```
  
   ./token.sh

   ```


